schema: '2.0'
stages:
  prepare_data:
    cmd: "python -m prepare_retrain_data  --data-dir ../inaturalist_12K  --max-drifted
      1000 --min-drifted 10 --batch-size 32  --generate-stats --save-datasets prepared_datasets.pkl\n"
    deps:
    - path: ../inaturalist_12K
      hash: md5
      md5: 89e7e55d248f1e61ecc608aba08b30a6.dir
      size: 3827152220
      nfiles: 36006
    - path: drift_check_report.json
      hash: md5
      md5: 18e5d295885e3dd7679346cf07c71ff4
      size: 102
    - path: prepare_retrain_data.py
      hash: md5
      md5: 6fc286f1909cb6b01f0064820c6dbc54
      size: 13314
    params:
      params.yaml:
        batch_size: 32
        data_dir: ../inaturalist_12K
        max_drifted: 1000
        min_drifted: 10
    outs:
    - path: prepared_data_stats.json
      hash: md5
      md5: 8969efdb67815a1f7fa31328bad0796f
      size: 175
    - path: prepared_datasets.pkl
      hash: md5
      md5: fdfdc24a4c2f338bdd035e50bd7ab79e
      size: 9450699
  check_drift:
    cmd: "python ../drift_pipeline/check_drift_batch.py --models-dir ../drift_pipeline/drift_models\n"
    deps:
    - path: ../drift_pipeline/check_drift_batch.py
      hash: md5
      md5: 27ab65c3c0614a919e0d89faba36a1bf
      size: 9479
    - path: ../drift_pipeline/database.py
      hash: md5
      md5: 4a7c2fa6126a53325c91f43e6eb363a4
      size: 4315
    - path: ../drift_pipeline/drift_models/drift_detector.joblib
      hash: md5
      md5: 20e1a407e54cc938ef164f555bec4eb8
      size: 20386195
    - path: ../drift_pipeline/drift_models/feature_extractor.pth
      hash: md5
      md5: ccb59c291b6bbe12cadacc9b0f61afb5
      size: 94354058
    - path: ../drift_pipeline/load_drift_detector.py
      hash: md5
      md5: e792305410b566d7d4cde7ad18b6e640
      size: 2512
    outs:
    - path: drift_check_report.json
      hash: md5
      md5: 18e5d295885e3dd7679346cf07c71ff4
      size: 102
